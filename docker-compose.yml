version: "3.9"

services:
  pi-face:
    build: .
    container_name: pi-face
    restart: unless-stopped

    environment:
      # 容器里统一用 /data，方便和 config.py 对齐
      DATA_ROOT: /data

      # 下面这几个根据你实际摄像头情况自己改
      HIK_IP: "192.168.1.111"
      HIK_USER: "admin"
      HIK_PWD: "Long-Live-NBALab"
      HIK_PORT: "554"
      HIK_CHANNEL_MAIN: "Streaming/Channels/101"
      HIK_CHANNEL_SUB: "Streaming/Channels/102"

      # MJPEG HTTP 服务配置
      HTTP_HOST: "0.0.0.0"
      HTTP_PORT: "5000"

      # face_runtime 读 MJPEG 的地址（容器内访问 127.0.0.1:5000）
      VIDEO_SOURCE: "http://127.0.0.1:5000/video_feed"

    ports:
      - "5000:5000"   # 对外暴露 MJPEG / snapshot

    volumes:
      # 你的数据卷：可以是宿主机 /data，也可以是项目下 ./data，看你习惯
      - ./data:/data
      # 可选：缓存 InspireFace 模型，避免每次启动都重新下载
      - ./inspireface-cache:/root/.inspireface

